<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.gson.room_store.model.mapper.statistical.StatisticsMapper">
    <!--查询本月精选好房-->
    <select id="statistics1" resultType="map">
        select count(t.Good_type) as 'number',Good_type as 'type' from(
                                                                          select Good_type from good where good_state='1' and
                                                                              DATE_FORMAT(good_date ,'%Y%m')= DATE_FORMAT( CURDATE( ) , '%Y%m' )
                                                                      ) t  group by t.Good_type
    </select>
    <!--查询客源人数-->
    <select id="statistics2" resultType="_int">
        SELECT count(*) from customerss
    </select>
    <!--查询跟进人数-->
    <select id="statistics6" resultType="_int">
        SELECT count(*) from rentalfollowup
    </select>
    <!--查询带看人数-->
    <select id="statistics7" resultType="_int">
        SELECT count(*) from look_record
    </select>
    <!--查询租房房源信息-->
    <select id="statistics3" resultType="map">
        select count(t.reho_shelf) as 'number',reho_shelf as 'type' from(
                                                                            select reho_shelf from rentalhousing
                                                                        ) t  group by t.reho_shelf
    </select>
    <!--查询二手房数据-->
    <select id="statistics4" resultType="map">
        select count(t.secondary_state) as 'number',secondary_state as 'type' from(
                                                                                      select secondary_state from secondary
                                                                                  ) t  group by t.secondary_state
    </select>
    <!--查询新房数据-->
    <select id="statistics5" resultType="map">
        select count(t.house_state) as 'number',house_state as 'type' from(
                                                                              select house_state from new_house
                                                                          ) t  group by t.house_state

    </select>
    <!--查询七天内新房新增-->
    <select id="statistics8" resultType="map">
        select a.click_date,b.count
        from (
                 SELECT curdate() as click_date
                 union all
                 SELECT date_sub(curdate(), interval 1 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 2 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 3 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 4 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 5 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 6 day) as click_date
             ) a left join (
            select date(reho_date) as datetime, count(*) as count
        from rentalhousing
        group by date(reho_date)
            ) b on a.click_date = b.datetime;
    </select>
    <!--查询七天内客源新增-->
    <select id="statistics9" resultType="map">
        select a.click_date,b.count
        from (
                 SELECT curdate() as click_date
                 union all
                 SELECT date_sub(curdate(), interval 1 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 2 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 3 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 4 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 5 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 6 day) as click_date
             ) a left join (
            select date(cus_entry) as datetime, count(*) as count
        from customerss
        group by date(cus_entry)
            ) b on a.click_date = b.datetime;
    </select>
    <!--查询七天内跟进新增-->
    <select id="statistics10" resultType="map">
        select a.click_date,b.count
        from (
                 SELECT curdate() as click_date
                 union all
                 SELECT date_sub(curdate(), interval 1 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 2 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 3 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 4 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 5 day) as click_date
                 union all
                 SELECT date_sub(curdate(), interval 6 day) as click_date
             ) a left join (
            select date(refo_date) as datetime, count(*) as count
        from rentalfollowup
        group by date(refo_date)
            ) b on a.click_date = b.datetime;
    </select>

</mapper>